(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[665],{2775:(e,t,s)=>{Promise.resolve().then(s.bind(s,4261))},33:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var r=s(5155),a=s(2115),l=s(6046),d=s(232);let i=e=>{let{allowedRoles:t,children:s,redirectTo:i="/"}=e,{user:c}=(0,d.J)(),n=(0,l.useRouter)(),[o,x]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{let e=localStorage.getItem("user");if(!e){n.push("/login");return}let s=JSON.parse(e).rank;if(!t.includes(s)){n.push(i);return}x(!1)},[c,t,i,n]),o)?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"})}):s}},232:(e,t,s)=>{"use strict";s.d(t,{J:()=>i,v:()=>d});var r=s(5155),a=s(2115);let l=(0,a.createContext)(),d=e=>{let{children:t}=e,[s,d]=(0,a.useState)(null);return(0,r.jsx)(l.Provider,{value:{user:s,setUser:d},children:t})},i=()=>(0,a.useContext)(l)},4261:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var r=s(5155),a=s(8173),l=s.n(a),d=s(7493),i=s(3100),c=s(8639),n=s(1354),o=s(7936),x=s(2115),m=s(2651),h=s(6046),u=s(6472),g=s(5781),b=s(33);function p(){let[e,t]=(0,x.useState)(0),[s,a]=(0,x.useState)(0),[g,b]=(0,x.useState)(0),[p,f]=(0,x.useState)([]),[j,N]=(0,x.useState)(null),y=(0,h.useRouter)(),[v,w]=(0,x.useState)(!1),[_,k]=(0,x.useState)(null),[S,E]=(0,x.useState)(null),A=async()=>{try{let e="".concat("https://suqia-481.onrender.com","/distributer_orders_by_company?distributer_id=").concat(j.id),t=await m.A.get(e);if(200===t.status){let e=t.data.map(e=>e.company_name),s=t.data.map(e=>e.total);E({labels:e,datasets:[{label:"عدد الطلبات لكل شركة",data:s,backgroundColor:"rgba(54, 162, 235, 0.6)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1}]})}}catch(e){console.error("Error fetching bar chart data:",e)}},C=async()=>{try{let e=await m.A.get("".concat("https://suqia-481.onrender.com","/distributer_total_price"));f(e.data)}catch(t){var e;console.error("Error fetching orders:",(null===(e=t.response)||void 0===e?void 0:e.data)||t.message)}finally{}};(0,x.useEffect)(()=>{let e=localStorage.getItem("user");N(e?JSON.parse(e):null),C()},[]),(0,x.useEffect)(()=>{(null==j?void 0:j.id)&&("user"==j.rank&&y.push("/"),q(),O(),P(),I(),A())},[j]);let q=async()=>{try{let e="".concat("https://suqia-481.onrender.com","/distributer_total_price?distributer_id=").concat(j.id),s=await m.A.get(e);200===s.status&&t(s.data.Price||0)}catch(e){console.error("Error fetching orders:",e)}},O=async()=>{try{let e="".concat("https://suqia-481.onrender.com","/distributer_completed_count?distributer_id=").concat(j.id),t=await m.A.get(e);200===t.status&&a(t.data.completedOrdersCount)}catch(e){console.error("Error fetching orders:",e)}},P=async()=>{try{let e="".concat("https://suqia-481.onrender.com","/distributer_waiting_count?distributer_id=").concat(j.id),t=await m.A.get(e);200===t.status&&b(t.data.waitingOrdersCount)}catch(e){console.error("Error fetching orders:",e)}},I=async()=>{try{let e="".concat("https://suqia-481.onrender.com","/distributer_completed_orders_chart?distributer_id=").concat(j.id),t=await m.A.get(e);if(200===t.status){let e=t.data.map(e=>e.date),s=t.data.map(e=>e.total);k({labels:e,datasets:[{label:"عدد الطلبات المكتملة",data:s,borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.2)",borderWidth:2,tension:.4}]})}}catch(e){console.error("Error fetching orders:",e)}};return(0,r.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-100",children:[(0,r.jsxs)("div",{className:"fixed right-0 min-h-[600px] w-64 bg-gray-50 text-black shadow-lg flex flex-col m-5 mt-20 rounded-3xl p-6 transition-transform duration-300 ease-in-out transform ".concat(v?"translate-x-0 top-20":"translate-x-full top-10"," md:translate-x-0 z-50"),children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-center text-black mb-8",children:"لوحة تحكم السائقين"}),(0,r.jsxs)("nav",{className:"flex flex-col space-y-4",children:[(0,r.jsxs)(l(),{href:"/dashboard/home",className:"flex items-center space-x-3 p-3 rounded-lg bg-gray-200 transition text-black",children:[(0,r.jsx)(d.A,{className:"w-5 h-5 text-gray-700 m-2"})," ",(0,r.jsx)("span",{children:"الرئيسية"})]}),(0,r.jsxs)(l(),{href:"/dashboard/new_orders",className:"flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-200 transition text-black",children:[(0,r.jsx)(i.A,{className:"w-5 h-5 text-gray-700 m-2"})," ",(0,r.jsx)("span",{children:"الطلبات الجارية"})]}),(0,r.jsxs)(l(),{href:"/dashboard/orders",className:"flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-200 transition text-black",children:[(0,r.jsx)(c.A,{className:"w-5 h-5 text-gray-700 m-2"})," ",(0,r.jsx)("span",{children:"الطلبات المكتملة"})]}),(0,r.jsxs)("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),N(null),y.push("/login")},className:"flex items-center space-x-3 p-3 rounded-lg hover:bg-red-300 transition mt-auto text-black",children:[(0,r.jsx)(n.A,{className:"w-5 h-5 text-gray-700 m-2"})," ",(0,r.jsx)("span",{children:"تسجيل خروج"})]})]})]}),(0,r.jsxs)("div",{className:"flex-grow p-6 text-black relative z-10 transition-padding duration-300 ".concat("md:pr-80 "),children:[(0,r.jsx)("button",{className:"top-20 right-5 z-50 bg-gray-100 p-2 rounded-full md:hidden",onClick:()=>w(!v),children:(0,r.jsx)(o.A,{className:"w-6 h-6 text-gray-700"})}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-right mb-8",children:"الصفحة الرئيسية"}),(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-2 text-blue-700",children:"اجمالي الدخل"}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-3",children:(0,r.jsx)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-3",children:(0,r.jsxs)("p",{className:"text-3xl font-bold text-gray-800",children:[e,"   ",(0,r.jsx)("img",{className:"h-4 md:h-5 w-auto inline-block",src:"/images/Saudi_Riyal_Symbol.svg",alt:"ريال سعودي"})]})})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-2 text-blue-700",children:"الطلبات الجديدة"}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-3",children:(0,r.jsx)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-3",children:(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-800",children:g})})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-2 text-blue-700",children:"اجمالي الطلبات المكتملة"}),(0,r.jsxs)("div",{className:"border-t border-gray-200 pt-3",children:[(0,r.jsx)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-3"}),(0,r.jsx)("p",{className:"text-3xl font-bold text-gray-800",children:s})]})]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4 text-blue-700",children:"معدل الطلبات"}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-4",children:_?(0,r.jsx)(u.N1,{data:_,options:{responsive:!0,plugins:{legend:{position:"top"}}}}):(0,r.jsx)("div",{className:"h-64 flex items-center justify-center",children:(0,r.jsx)("p",{className:"text-gray-500",children:"Loading chart..."})})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4 text-blue-700",children:"عدد الطلبات لكل شركة"}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-4",children:S?(0,r.jsx)(u.yP,{data:S,options:{responsive:!0,plugins:{legend:{position:"top"}}}}):(0,r.jsx)("div",{className:"h-64 flex items-center justify-center",children:(0,r.jsx)("p",{className:"text-gray-500",children:"Loading chart..."})})})]})]})]})]})}function f(){return(0,r.jsx)(b.A,{allowedRoles:["distributer"],redirectTo:"/",children:(0,r.jsx)(p,{})})}g.t1.register(g.E8,g.No,g.FN,g.kc,g.hE,g.PP,g.m_,g.s$)}},e=>{var t=t=>e(e.s=t);e.O(0,[647,616,651,46,441,517,358],()=>t(2775)),_N_E=e.O()}]);