(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[665],{2775:(e,t,s)=>{Promise.resolve().then(s.bind(s,4261))},4261:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(5155),r=s(8173),l=s.n(r),d=s(7493),c=s(3100),o=s(8639),i=s(1354),n=s(7936),h=s(2115),x=s(2651),m=s(6046),g=s(6472),b=s(5781);function u(){let[e,t]=(0,h.useState)(0),[s,r]=(0,h.useState)(0),[b,u]=(0,h.useState)(0),[p,f]=(0,h.useState)([]),[j,N]=(0,h.useState)(null),y=(0,m.useRouter)(),[v,w]=(0,h.useState)(!1),[_,k]=(0,h.useState)(null),[S,E]=(0,h.useState)(null),A=async()=>{try{let e="".concat("http://localhost:2000","/distributer_orders_by_company?distributer_id=").concat(j.id),t=await x.A.get(e);if(200===t.status){let e=t.data.map(e=>e.company_name),s=t.data.map(e=>e.total);E({labels:e,datasets:[{label:"عدد الطلبات لكل شركة",data:s,backgroundColor:"rgba(54, 162, 235, 0.6)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1}]})}}catch(e){console.error("Error fetching bar chart data:",e)}},C=async()=>{try{let e=await x.A.get("".concat("http://localhost:2000","/distributer_total_price"));f(e.data)}catch(t){var e;console.error("Error fetching orders:",(null===(e=t.response)||void 0===e?void 0:e.data)||t.message)}finally{}};(0,h.useEffect)(()=>{let e=localStorage.getItem("user");N(e?JSON.parse(e):null),C()},[]),(0,h.useEffect)(()=>{(null==j?void 0:j.id)&&("user"==j.rank&&y.push("/"),O(),P(),z(),I(),A())},[j]);let O=async()=>{try{let e="".concat("http://localhost:2000","/distributer_total_price?distributer_id=").concat(j.id),s=await x.A.get(e);200===s.status&&t(s.data.Price||0)}catch(e){console.error("Error fetching orders:",e)}},P=async()=>{try{let e="".concat("http://localhost:2000","/distributer_completed_count?distributer_id=").concat(j.id),t=await x.A.get(e);200===t.status&&r(t.data.completedOrdersCount)}catch(e){console.error("Error fetching orders:",e)}},z=async()=>{try{let e="".concat("http://localhost:2000","/distributer_waiting_count?distributer_id=").concat(j.id),t=await x.A.get(e);200===t.status&&u(t.data.waitingOrdersCount)}catch(e){console.error("Error fetching orders:",e)}},I=async()=>{try{let e="".concat("http://localhost:2000","/distributer_completed_orders_chart?distributer_id=").concat(j.id),t=await x.A.get(e);if(200===t.status){let e=t.data.map(e=>e.date),s=t.data.map(e=>e.total);k({labels:e,datasets:[{label:"عدد الطلبات المكتملة",data:s,borderColor:"rgba(75, 192, 192, 1)",backgroundColor:"rgba(75, 192, 192, 0.2)",borderWidth:2,tension:.4}]})}}catch(e){console.error("Error fetching orders:",e)}};return(0,a.jsxs)("div",{className:"flex flex-col min-h-screen bg-gray-100",children:[(0,a.jsxs)("div",{className:"fixed right-0 min-h-[600px] w-64 bg-gray-50 text-black shadow-lg flex flex-col m-5 mt-20 rounded-3xl p-6 transition-transform duration-300 ease-in-out transform ".concat(v?"translate-x-0 top-20":"translate-x-full top-10"," md:translate-x-0 z-50"),children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-center text-black mb-8",children:"لوحة تحكم السائقين"}),(0,a.jsxs)("nav",{className:"flex flex-col space-y-4",children:[(0,a.jsxs)(l(),{href:"/dashboard/home",className:"flex items-center space-x-3 p-3 rounded-lg bg-gray-200 transition text-black",children:[(0,a.jsx)(d.A,{className:"w-5 h-5 text-gray-700 m-2"})," ",(0,a.jsx)("span",{children:"الرئيسية"})]}),(0,a.jsxs)(l(),{href:"/dashboard/new_orders",className:"flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-200 transition text-black",children:[(0,a.jsx)(c.A,{className:"w-5 h-5 text-gray-700 m-2"})," ",(0,a.jsx)("span",{children:"الطلبات الجارية"})]}),(0,a.jsxs)(l(),{href:"/dashboard/orders",className:"flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-200 transition text-black",children:[(0,a.jsx)(o.A,{className:"w-5 h-5 text-gray-700 m-2"})," ",(0,a.jsx)("span",{children:"الطلبات المكتملة"})]}),(0,a.jsxs)("button",{onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),N(null),y.push("/login")},className:"flex items-center space-x-3 p-3 rounded-lg hover:bg-red-300 transition mt-auto text-black",children:[(0,a.jsx)(i.A,{className:"w-5 h-5 text-gray-700 m-2"})," ",(0,a.jsx)("span",{children:"تسجيل خروج"})]})]})]}),(0,a.jsxs)("div",{className:"flex-grow p-6 text-black relative z-10 transition-padding duration-300 ".concat("md:pr-80 "),children:[(0,a.jsx)("button",{className:"top-20 right-5 z-50 bg-gray-100 p-2 rounded-full md:hidden",onClick:()=>w(!v),children:(0,a.jsx)(n.A,{className:"w-6 h-6 text-gray-700"})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-right mb-8",children:"الصفحة الرئيسية"}),(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2 text-blue-700",children:"اجمالي الدخل"}),(0,a.jsx)("div",{className:"border-t border-gray-200 pt-3",children:(0,a.jsx)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-3",children:(0,a.jsxs)("p",{className:"text-3xl font-bold text-gray-800",children:[e,"   ",(0,a.jsx)("img",{className:"h-4 md:h-5 w-auto inline-block",src:"/images/Saudi_Riyal_Symbol.svg",alt:"ريال سعودي"})]})})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2 text-blue-700",children:"الطلبات الجديدة"}),(0,a.jsx)("div",{className:"border-t border-gray-200 pt-3",children:(0,a.jsx)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-3",children:(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-800",children:b})})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2 text-blue-700",children:"اجمالي الطلبات المكتملة"}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-3",children:[(0,a.jsx)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-3"}),(0,a.jsx)("p",{className:"text-3xl font-bold text-gray-800",children:s})]})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4 text-blue-700",children:"معدل الطلبات"}),(0,a.jsx)("div",{className:"border-t border-gray-200 pt-4",children:_?(0,a.jsx)(g.N1,{data:_,options:{responsive:!0,plugins:{legend:{position:"top"}}}}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Loading chart..."})})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4 text-blue-700",children:"عدد الطلبات لكل شركة"}),(0,a.jsx)("div",{className:"border-t border-gray-200 pt-4",children:S?(0,a.jsx)(g.yP,{data:S,options:{responsive:!0,plugins:{legend:{position:"top"}}}}):(0,a.jsx)("div",{className:"h-64 flex items-center justify-center",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Loading chart..."})})})]})]})]})]})}b.t1.register(b.E8,b.No,b.FN,b.kc,b.hE,b.PP,b.m_,b.s$)}},e=>{var t=t=>e(e.s=t);e.O(0,[647,616,651,46,441,517,358],()=>t(2775)),_N_E=e.O()}]);